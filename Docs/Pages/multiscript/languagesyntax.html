<h2>MultiScript Language Syntax</h2>

<p>MultiScript is Multi Commander's built-in scripting language that provides powerful automation capabilities through a simple yet comprehensive syntax. Understanding MultiScript syntax enables you to create sophisticated automation scripts, custom commands, and advanced file management workflows that extend Multi Commander's functionality beyond basic operations.</p>

<div class="alert alert-primary">
	<h6><i class="bi bi-code-slash me-2"></i>Comprehensive Scripting Language</h6>
	<p class="mb-0">MultiScript provides a complete programming environment with variables, functions, classes, control structures, and extensive built-in functions. The language is designed for ease of use while maintaining the power needed for complex automation tasks in file management and system administration scenarios.</p>
</div>

<nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
	<div class="container-fluid">
		<span class="navbar-brand">Quick Navigation</span>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#languageSyntaxNav">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="languageSyntaxNav">
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link" href="#basic-syntax">Basic Syntax</a></li>
				<li class="nav-item"><a class="nav-link" href="#data-types">Data Types</a></li>
				<li class="nav-item"><a class="nav-link" href="#operators">Operators</a></li>
				<li class="nav-item"><a class="nav-link" href="#control-structures">Control Structures</a></li>
				<li class="nav-item"><a class="nav-link" href="#functions-classes">Functions & Classes</a></li>
			</ul>
		</div>
	</div>
</nav>

<section id="basic-syntax">
	<h3>Basic Language Syntax Rules</h3>
	<p>MultiScript follows specific syntax rules that ensure consistent and predictable script execution across all Multi Commander environments.</p>

	<div class="row">
		<div class="col-md-12">
			<div class="card">
				<div class="card-header bg-info text-white">
					<h6 class="mb-0"><i class="bi bi-list-ul me-2"></i>Fundamental Syntax Rules</h6>
				</div>
				<div class="card-body">
					<h6>Script Execution Model</h6>
					<ul class="small">
						<li><strong>Line-by-Line Processing:</strong> MultiScript is a line-by-line engine - every command must be on a single line</li>
						<li><strong>Statement Termination:</strong> Commands should end with semicolon (<code>;</code>) for future compatibility</li>
						<li><strong>Scope Declaration:</strong> New scope is declared with curly braces <code>{ }</code> for conditions, loops, functions, and classes</li>
						<li><strong>Expression Evaluation:</strong> Left-to-right evaluation with parentheses taking precedence</li>
					</ul>

					<h6>Comment Syntax</h6>
					<ul class="small">
						<li><strong>Comment Lines:</strong> Lines starting with <code>//</code> or <code>#</code> are treated as comments</li>
						<li><strong>Inline Comments:</strong> Not supported - comments cannot be on the same line as valid code</li>
						<li><strong>Documentation:</strong> Use comments to document complex logic and script functionality</li>
					</ul>

					<div class="alert alert-warning p-2 mt-3">
						<h6 class="small mb-1"><i class="bi bi-exclamation-triangle me-1"></i>Expression Evaluation Important</h6>
						<p class="small mb-0"><strong>Operator Precedence:</strong> MultiScript evaluates expressions left-to-right without operator precedence. Use parentheses to control evaluation order: <code>2 + 4 * 8</code> equals 48, but <code>2 + (4 * 8)</code> equals 34.</p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row mt-3">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-success text-white">
					<h6 class="mb-0"><i class="bi bi-code me-2"></i>Basic Syntax Example</h6>
				</div>
				<div class="card-body">
					<pre class="mscode">// Calculate string length
@var $str = "Hello World";
@var $len = StrLen($str);
if( $len &gt; 10 )
{
  $str = "Too long";
}</pre>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-warning text-dark">
					<h6 class="mb-0"><i class="bi bi-tags me-2"></i>Reserved Keywords</h6>
				</div>
				<div class="card-body">
					<div class="table-responsive">
						<table class="table table-sm table-bordered">
							<tbody>
								<tr>
									<td><code>if</code></td>
									<td><code>for</code></td>
									<td><code>while</code></td>
									<td><code>break</code></td>
								</tr>
								<tr>
									<td><code>continue</code></td>
									<td><code>return</code></td>
									<td><code>function</code></td>
									<td><code>class</code></td>
								</tr>
								<tr>
									<td><code>new</code></td>
									<td><code>@var</code></td>
									<td><code>@gvar</code></td>
									<td></td>
								</tr>
							</tbody>
						</table>
					</div>
					<p class="small mb-0">These words cannot be used for variable or function names.</p>
				</div>
			</div>
		</div>
	</div>
</section>

<section id="data-types" class="mt-5">
	<h3>Data Types and Variables</h3>
	<p>MultiScript supports five primary data types with automatic type conversion capabilities and flexible variable declaration options for various programming scenarios.</p>

	<div class="row">
		<div class="col-md-12">
			<div class="card">
				<div class="card-header bg-primary text-white">
					<h6 class="mb-0"><i class="bi bi-database me-2"></i>Supported Data Types</h6>
				</div>
				<div class="card-body">
					<div class="table-responsive">
						<table class="table table-bordered table-hover">
							<thead class="table-light">
								<tr>
									<th style="width: 20%">Data Type</th>
									<th style="width: 30%">Description</th>
									<th style="width: 50%">Examples</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><strong>String</strong></td>
									<td>Text data with escape sequence support</td>
									<td><code>"Hello World"</code>, <code>'File path'</code>, <code>"Line1\nLine2"</code></td>
								</tr>
								<tr>
									<td><strong>Number</strong></td>
									<td>Integer and floating-point values</td>
									<td><code>42</code>, <code>3.14</code>, <code>-100</code></td>
								</tr>
								<tr>
									<td><strong>Array</strong></td>
									<td>Collection of multiple values</td>
									<td><code>{"item1", "item2"}</code>, <code>{1, 2, 3}</code></td>
								</tr>
								<tr>
									<td><strong>Object</strong></td>
									<td>Class instances with properties and methods</td>
									<td><code>new MyClass</code>, <code>$obj.property</code></td>
								</tr>
								<tr>
									<td><strong>Handle</strong></td>
									<td>References to system resources</td>
									<td><code>FilterCreate()</code>, <code>$filter</code></td>
								</tr>
							</tbody>
						</table>
					</div>

					<h6>Type Conversion Features</h6>
					<ul class="small">
						<li><strong>Automatic Conversion:</strong> String-to-number and number-to-string conversions happen automatically</li>
						<li><strong>String Concatenation:</strong> Numbers can be concatenated directly to strings</li>
						<li><strong>Type Checking Functions:</strong> <code>IsTypeString()</code>, <code>IsTypeNum()</code>, <code>IsTypeArray()</code>, <code>IsTypeHandle()</code></li>
						<li><strong>Manual Conversion:</strong> <code>strtonum()</code> and <code>numtostr()</code> for explicit type conversion</li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<div class="row mt-3">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-success text-white">
					<h6 class="mb-0"><i class="bi bi-gear me-2"></i>Variable Declaration</h6>
				</div>
				<div class="card-body">
					<h6>Variable Declaration Syntax</h6>
					<pre class="mscode">// Single variable
@var $v1;

// Multiple variables
@var $v1, $v2, $v3;

// With initialization
@var $v1 = 0;
@var $v2 = "Hello";
@var $v3 = MyFunc();

// Global scope variable
@gvar $globalVar;</pre>

					<h6>Variable Rules</h6>
					<ul class="small">
						<li><strong>Naming:</strong> Must start with <code>$</code>, contain only a-z, A-Z, 0-9</li>
						<li><strong>Scope:</strong> Variables exist within their declaration scope</li>
						<li><strong>Shadowing:</strong> Local variables can shadow outer scope variables</li>
						<li><strong>Global Access:</strong> Use <code>@gvar</code> to declare in global scope</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-warning text-dark">
					<h6 class="mb-0"><i class="bi bi-list me-2"></i>Arrays and Constants</h6>
				</div>
				<div class="card-body">
					<h6>Array Declaration</h6>
					<pre class="mscode">// Fixed size array
@var $arr[3];

// Initialized arrays
@var $strArr[] = {"A", "B", "C"};
@var $numArr[] = {1, 2, 3};

// Mixed type array
@var $mixed[] = {"text", 42, "more"};</pre>

					<h6>String Constants and Escape Sequences</h6>
					<div class="table-responsive">
						<table class="table table-sm table-bordered">
							<tbody>
								<tr><td><code>\n</code></td><td>Newline</td></tr>
								<tr><td><code>\r</code></td><td>Carriage return</td></tr>
								<tr><td><code>\t</code></td><td>Tab</td></tr>
								<tr><td><code>\"</code></td><td>Double quote</td></tr>
								<tr><td><code>\\</code></td><td>Backslash</td></tr>
							</tbody>
						</table>
					</div>
					<p class="small mb-0"><strong>Note:</strong> Use double quotes for escape sequences, single quotes for literal strings.</p>
				</div>
			</div>
		</div>
	</div>
</section>

<section id="operators" class="mt-5">
	<h3>Operators and Expressions</h3>
	<p>MultiScript provides comprehensive operator support for arithmetic, comparison, assignment, and special operations including the unique path concatenation operator for file system operations.</p>

	<div class="row">
		<div class="col-md-12">
			<div class="card">
				<div class="card-header bg-dark text-white">
					<h6 class="mb-0"><i class="bi bi-calculator me-2"></i>Complete Operator Reference</h6>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-md-6">
							<h6>Arithmetic Operators</h6>
							<div class="table-responsive">
								<table class="table table-sm table-bordered">
									<thead class="table-light">
										<tr><th>Operator</th><th>Description</th><th>Example</th></tr>
									</thead>
									<tbody>
										<tr><td><code>+</code></td><td>Addition / String concatenation</td><td><code>5 + 3</code>, <code>"A" + "B"</code></td></tr>
										<tr><td><code>-</code></td><td>Subtraction</td><td><code>10 - 3</code></td></tr>
										<tr><td><code>*</code></td><td>Multiplication</td><td><code>4 * 5</code></td></tr>
										<tr><td><code>/</code></td><td>Division</td><td><code>20 / 4</code></td></tr>
									</tbody>
								</table>
							</div>

							<h6>Assignment Operators</h6>
							<div class="table-responsive">
								<table class="table table-sm table-bordered">
									<thead class="table-light">
										<tr><th>Operator</th><th>Description</th><th>Example</th></tr>
									</thead>
									<tbody>
										<tr><td><code>=</code></td><td>Assignment</td><td><code>$x = 5</code></td></tr>
										<tr><td><code>+=</code></td><td>Add and assign</td><td><code>$x += 3</code></td></tr>
										<tr><td><code>-=</code></td><td>Subtract and assign</td><td><code>$x -= 2</code></td></tr>
									</tbody>
								</table>
							</div>
						</div>
						<div class="col-md-6">
							<h6>Comparison Operators</h6>
							<div class="table-responsive">
								<table class="table table-sm table-bordered">
									<thead class="table-light">
										<tr><th>Operator</th><th>Description</th><th>Example</th></tr>
									</thead>
									<tbody>
										<tr><td><code>==</code></td><td>Equal to</td><td><code>$x == 5</code></td></tr>
										<tr><td><code>&gt;</code></td><td>Greater than</td><td><code>$x &gt; 10</code></td></tr>
										<tr><td><code>&lt;</code></td><td>Less than</td><td><code>$x &lt; 20</code></td></tr>
										<tr><td><code>&gt;=</code></td><td>Greater or equal</td><td><code>$x &gt;= 5</code></td></tr>
										<tr><td><code>&lt;=</code></td><td>Less or equal</td><td><code>$x &lt;= 15</code></td></tr>
									</tbody>
								</table>
							</div>

							<h6>Special Operators</h6>
							<div class="table-responsive">
								<table class="table table-sm table-bordered">
									<thead class="table-light">
										<tr><th>Operator</th><th>Description</th><th>Example</th></tr>
									</thead>
									<tbody>
										<tr><td><code>!</code></td><td>Logical negation</td><td><code>!$condition</code></td></tr>
										<tr><td><code>^</code></td><td>Path concatenation</td><td><code>$path ^ "file.txt"</code></td></tr>
										<tr><td><code>[ ]</code></td><td>Index operator</td><td><code>$arr[0]</code>, <code>$str[2]</code></td></tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>

					<div class="alert alert-info p-2 mt-3">
						<h6 class="small mb-1"><i class="bi bi-folder me-1"></i>Path Concatenation Operator</h6>
						<p class="small mb-0">The <code>^</code> operator intelligently handles path separation: <code>"C:\Path" ^ "file.txt"</code> becomes <code>"C:\Path\file.txt"</code>, automatically adding backslashes when needed while removing duplicates.</p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row mt-3">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-primary text-white">
					<h6 class="mb-0"><i class="bi bi-code-square me-2"></i>Expression Examples</h6>
				</div>
				<div class="card-body">
					<pre class="mscode">// Arithmetic with parentheses
@var $result = 5 + (4 * 2); // = 13

// String concatenation
@var $msg = "Hello" + " " + "World";

// Path operations
@var $fullPath = $basePath ^ $fileName;

// Comparison
if( $value &gt;= 10 && $value &lt;= 20 )
{
  // Process value in range
}</pre>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-success text-white">
					<h6 class="mb-0"><i class="bi bi-list-check me-2"></i>Index Operator Usage</h6>
				</div>
				<div class="card-body">
					<pre class="mscode">// Array indexing
@var $arr[] = {"A", "B", "C"};
@var $first = $arr[0];  // "A"
$arr[1] = "Modified";   // Change element

// String character access
@var $str = "Hello";
@var $firstChar = $str[0];  // "H"
$str[0] = "J";             // "Jello"

// Character manipulation
@var $str2 = "12345";
$str[1] = $str2[3];        // "H4llo"</pre>
				</div>
			</div>
		</div>
	</div>
</section>

<section id="control-structures" class="mt-5">
	<h3>Control Structures</h3>
	<p>MultiScript provides standard control structures for conditional execution and iteration, enabling complex program logic and automated processing workflows.</p>

	<div class="row">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-warning text-dark">
					<h6 class="mb-0"><i class="bi bi-diagram-3 me-2"></i>Conditional Statements</h6>
				</div>
				<div class="card-body">
					<h6>IF-ELSE Structure</h6>
					<pre class="mscode">if( $condition )
{
  // Execute if true
}
else if( $otherCondition )
{
  // Execute if first false, this true
}
else
{
  // Execute if all conditions false
}</pre>

					<h6>Conditional Logic Rules</h6>
					<ul class="small">
						<li><strong>Boolean Evaluation:</strong> Values ? 1 are true, &lt; 1 are false</li>
						<li><strong>Scope Variables:</strong> Variables declared inside IF scope are local</li>
						<li><strong>Variable Shadowing:</strong> Inner scope variables can shadow outer ones</li>
						<li><strong>Nested Conditions:</strong> IF statements can be nested to any depth</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-info text-white">
					<h6 class="mb-0"><i class="bi bi-arrow-repeat me-2"></i>Loop Structures</h6>
				</div>
				<div class="card-body">
					<h6>FOR Loop</h6>
					<pre class="mscode">@var $n;
for( $n = 0; $n &lt; 5; $n++ )
{
  if( $n == 2 )
  {
    continue; // Skip iteration
  }
  if( $n == 4 )
  {
    break;    // Exit loop
  }
}</pre>

					<h6>WHILE Loop</h6>
					<pre class="mscode">@var $n = 10;
while( $n &gt; 0 )
{
  $n--;
  // Process items
}</pre>

					<p class="small mb-0"><strong>Note:</strong> Loop variable must be declared outside the FOR statement.</p>
				</div>
			</div>
		</div>
	</div>

	<div class="row mt-3">
		<div class="col-md-12">
			<div class="card">
				<div class="card-header bg-success text-white">
					<h6 class="mb-0"><i class="bi bi-arrow-left-right me-2"></i>Loop Control and Flow</h6>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-md-4">
							<h6>Loop Control Keywords</h6>
							<ul class="small">
								<li><strong>break:</strong> Exit the loop immediately</li>
								<li><strong>continue:</strong> Skip to next iteration</li>
								<li><strong>return:</strong> Exit function and optionally return value</li>
							</ul>
						</div>
						<div class="col-md-4">
							<h6>FOR Loop Components</h6>
							<ul class="small">
								<li><strong>Init Expression:</strong> Executed once before loop starts</li>
								<li><strong>Condition:</strong> Evaluated before each iteration</li>
								<li><strong>Loop Expression:</strong> Executed after each iteration</li>
							</ul>
						</div>
						<div class="col-md-4">
							<h6>WHILE Loop Features</h6>
							<ul class="small">
								<li><strong>Condition Check:</strong> Evaluated before each iteration</li>
								<li><strong>Variable Scope:</strong> Access to outer scope variables</li>
								<li><strong>Infinite Loops:</strong> Use break or return to exit</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<section id="functions-classes" class="mt-5">
	<h3>Functions and Classes</h3>
	<p>MultiScript supports user-defined functions and basic object-oriented programming through classes, enabling code reuse, modular design, and organized script architecture.</p>

	<div class="row">
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-primary text-white">
					<h6 class="mb-0"><i class="bi bi-code me-2"></i>Function Definition</h6>
				</div>
				<div class="card-body">
					<h6>Function Syntax</h6>
					<pre class="mscode">function MyFunction( $param1, $param2 )
{
  @var $result = $param1 + $param2;
  $result = $result * 2;
  return $result;
}

// Function call
@var $value = MyFunction( 5, 10 );</pre>

					<h6>Function Features</h6>
					<ul class="small">
						<li><strong>Declaration Order:</strong> Functions must be defined before they are called</li>
						<li><strong>Parameter Passing:</strong> All parameters passed by value (copied)</li>
						<li><strong>Return Values:</strong> Functions return 1 by default, use <code>return</code> for custom values</li>
						<li><strong>Local Scope:</strong> Function variables are local to the function</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="card">
				<div class="card-header bg-warning text-dark">
					<h6 class="mb-0"><i class="bi bi-diagram-2 me-2"></i>Class Definition</h6>
				</div>
				<div class="card-body">
					<h6>Class Syntax</h6>
					<pre class="mscode">class MyClass
{
  @var $property1 = 0;
  @var $property2 = "default";
  
  function MyMethod( $param )
  {
    $property1 = $param;
    return $property1 * 2;
  }
}

// Object creation and usage
@var $obj = new MyClass;
@var $result = $obj.MyMethod( 10 );
@var $value = $obj.property1;</pre>

					<h6>Class Features</h6>
					<ul class="small">
						<li><strong>Object Creation:</strong> Use <code>new</code> keyword to create instances</li>
						<li><strong>Property Access:</strong> Use dot notation without <code>$</code> prefix</li>
						<li><strong>Method Calls:</strong> Standard function call syntax with dot notation</li>
						<li><strong>Public Access:</strong> All properties and methods are public</li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<div class="row mt-3">
		<div class="col-md-12">
			<div class="card">
				<div class="card-header bg-success text-white">
					<h6 class="mb-0"><i class="bi bi-gear-wide-connected me-2"></i>Advanced Function and Class Concepts</h6>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-md-6">
							<h6>Function Best Practices</h6>
							<ul class="small">
								<li><strong>Early Definition:</strong> Define all functions at the beginning of scripts</li>
								<li><strong>Meaningful Names:</strong> Use descriptive function names that indicate purpose</li>
								<li><strong>Return Values:</strong> Always use explicit return statements for clarity</li>
								<li><strong>Error Handling:</strong> Validate parameters and handle edge cases</li>
								<li><strong>Documentation:</strong> Use comments to document function purpose and parameters</li>
							</ul>

							<h6>Parameter Passing Example</h6>
							<pre class="mscode">function ModifyValue( $input )
{
  $input = $input * 2;  // Only modifies copy
  return $input;
}

@var $original = 10;
@var $modified = ModifyValue( $original );
// $original is still 10, $modified is 20</pre>
						</div>
						<div class="col-md-6">
							<h6>Class Usage Patterns</h6>
							<ul class="small">
								<li><strong>Object Lifetime:</strong> Objects exist until script completion</li>
								<li><strong>No Destructors:</strong> Cannot explicitly delete objects</li>
								<li><strong>Simple OOP:</strong> Basic object-oriented features without inheritance</li>
								<li><strong>State Management:</strong> Use objects to maintain related data and methods</li>
								<li><strong>Encapsulation:</strong> Group related functionality in logical units</li>
							</ul>

							<h6>Object Property Access</h6>
							<pre class="mscode">// INCORRECT - Don't use $ in property access
@var $value = $obj.$property;

// CORRECT - Use dot notation without $
@var $value = $obj.property;
$obj.property = "new value";

// Method calls
@var $result = $obj.CalculateValue( $param );</pre>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<div class="alert alert-success mt-5">
	<h6><i class="bi bi-lightbulb me-2"></i>MultiScript Syntax Mastery</h6>
	<p class="mb-0">Master MultiScript by understanding line-by-line execution, using parentheses for expression control, and leveraging the powerful data types and operators. Remember that variables must start with <code>$</code>, functions must be defined before use, and the path concatenation operator <code>^</code> simplifies file system operations. Use proper scoping with <code>@var</code> for local and <code>@gvar</code> for global variables, and always validate expressions with parentheses when combining multiple operations for predictable results.</p>
</div>

<div class="alert alert-info mt-4">
	<h6><i class="bi bi-info-circle me-2"></i>Related MultiScript Documentation</h6>
	<p class="mb-0">Continue learning MultiScript with: <a href="/Docs/multiscript/corefunctions" class="text-decoration-none">Core Functions</a>, <a href="/Docs/multiscript/functions/string" class="text-decoration-none">String Functions</a>, <a href="/Docs/multiscript/functions/array" class="text-decoration-none">Array Functions</a>, <a href="/Docs/multiscript/functions/filesystem" class="text-decoration-none">File System Functions</a>, <a href="/Docs/multiscript/examples" class="text-decoration-none">Practical Examples</a>, <a href="/Docs/UDC_multiscript" class="text-decoration-none">User Defined Commands</a>, and <a href="/Docs/UDC_multiscript_debugger" class="text-decoration-none">MultiScript Debugger</a>.</p>
</div>


